(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{46:function(t,e,a){t.exports=a(64)},51:function(t,e,a){},64:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(16),o=a.n(i),s=(a(51),a(17)),c=a(15),u=a.n(c),l=a(41),d=a(24),m=a(4),h=a(5),p=a(12),g=a(10),f=a(11),v=a(27),S=a(84),I=a(80),O=a(25),b=a(26),T={ActionButton:{height:"60px",width:"200px",fontSize:24,backgroundColor:function(t){return t.disabled?O.a[500]:b.a[500]},"&:hover":{backgroundColor:b.a[200]},color:"#fff",fontWeight:"lighter",marginTop:"20px",marginBottom:"60px"}},y=function(t){function e(){return Object(m.a)(this,e),Object(p.a)(this,Object(g.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=this.props.classes;return r.a.createElement(I.a,{className:e.ActionButton,onClick:function(){t.props.onAnnotationButtonClicked(t.props.name)},disabled:this.props.disabled},this.props.name)}}]),e}(n.Component),R=Object(S.a)(T)(y),E=function t(e,a,n){var r=this;Object(m.a)(this,t),this.hasMedia=function(){return null!=(r.stream||r.url)},this.getAnnotationForTimestamp=function(t){var e;return r.annotations&&r.annotations.forEach(function(a){t<a.timestamp+a.totalDuration/2&&t>a.timestamp-a.totalDuration/2&&(e=a)}),e},this.annotations=e,this.url=a,this.stream=n},A=a(81),w=a(36),P=a.n(w),k=a(35),_=a.n(k),j=a(34),C=a.n(j),x={NONE:"NONE",START:"START",STOP:"STOP",PAUSE:"PAUSE",RESUME:"RESUME"},N={token:"unique recording state token"},D=function(){function t(e,a){if(Object(m.a)(this,t),e!==N)throw new Error("RecordingState is an enum and should not be constructed directly; please use an existing RecordingState.* declared in recording_state.es6.js");this._status=a}return Object(h.a)(t,[{key:"isActive",value:function(){return this===t.RECORDING||this===t.PAUSED}},{key:"isRecording",value:function(){return this===t.RECORDING}},{key:"isPaused",value:function(){return this===t.PAUSED}},{key:"isOff",value:function(){return this===t.OFF}},{key:"isStartingOrStopping",value:function(){return this===t.STARTING||this===t.STOPPING}},{key:"start",value:function(){return this===t.OFF?t.STARTING:this}},{key:"stop",value:function(){return this===t.OFF?t.OFF:t.STOPPING}},{key:"pause",value:function(){return t.PAUSED}},{key:"resume",value:function(){return t.RECORDING}},{key:"compareToPrevious",value:function(e){return this===t.STARTING&&e===t.OFF?x.START:this===t.STOPPING&&e!==t.STOPPING?x.STOP:this===t.RECORDING&&e===t.PAUSED?x.RESUME:this===t.PAUSED&&e===t.RECORDING?x.PAUSE:x.NONE}}]),t}();D.OFF=new D(N,"OFF"),D.STARTING=new D(N,"STARTING"),D.RECORDING=new D(N,"RECORDING"),D.PAUSED=new D(N,"PAUSED"),D.STOPPING=new D(N,"STOPPING");var M=D,G=a(28),F=a.n(G),B={RecordingButton:{height:"60px",width:"60px",marginBottom:"70px",backgroundColor:F.a[600],"&:hover":{backgroundColor:F.a[200]},color:"#fff"},RecordingButtonLabel:{height:"30px",width:"30px"}},U=function(t){function e(){return Object(m.a)(this,e),Object(p.a)(this,Object(g.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props.classes;return r.a.createElement(A.a,{className:t.RecordingButton,"aria-label":"record",onClick:this.props.onClick},this.props.recordingState===M.RECORDING?r.a.createElement(C.a,{className:t.RecordingButtonLabel}):this.props.hasRecording?r.a.createElement(_.a,{className:t.RecordingButtonLabel}):r.a.createElement(P.a,{className:t.RecordingButtonLabel}))}}]),e}(r.a.Component),L=Object(S.a)(B)(U),z=6,W=60,q=1e3,H={Scroll:{width:q,overflow:"hidden",direction:"rtl",margin:"20px",alignSelf:"center",alignItems:"center"},Canvas:{float:"right",height:"300px"}},V=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(p.a)(this,Object(g.a)(e).call(this,t))).componentDidUpdate=function(t,e){e.audioArray!==a.state.audioArray&&a._draw();var n=t.audioItem,r=a.props.audioItem;!n.hasMedia()&&r.hasMedia()?(a.audioContext=new(window.AudioContext||window.webkitAudioContext),a.analyser=a.audioContext.createAnalyser(),a.analyser.smoothingTimeConstant=0,a.dataArray=new Uint8Array(a.analyser.frequencyBinCount),r.stream?(a.source=a.audioContext.createMediaStreamSource(r.stream),a.source.connect(a.analyser)):r.url&&console.log("HAVE URL"),a.timerID=setInterval(function(){a.props.recordingState===M.RECORDING&&a._onRefreshVisualizer()},W)):t.audioStream&&null==a.props.audioStream&&a.setState({audioArray:[],width:q})},a.componentWillUnmount=function(){clearInterval(a.timerID),console.log(a.analyser),a.analyser&&a.analyser.disconnect(),a.source&&a.source.disconnect()},a.stop=function(){clearInterval(a.timerID)},a._onRefreshVisualizer=function(){a.analyser.getByteFrequencyData(a.dataArray);for(var t=0,e=0;e<a.dataArray.length;e++)t+=a.dataArray[e];var n=Object(s.a)(a.state.audioArray),r=a.props.audioItem&&a.props.audioItem.getAnnotationForTimestamp(a.props.elapsedTimeMs);if(null!=r){var i=a.state.audioArray.slice(-r.totalDuration/2/W).map(function(t){return{amplitude:t.amplitude,annotated:!0,timestamp:t.elapsedTimeMs}});n.splice.apply(n,[n.length-i.length,r.totalDuration/2/W].concat(Object(s.a)(i)))}var o=t/a.dataArray.length;a.setState({width:a.state.audioArray.length*z,audioArray:[].concat(Object(s.a)(n),[{amplitude:o,annotated:null!=r,timestamp:a.props.elapsedTimeMs}])})},a._draw=function(){var t=a.canvas.current,e=t.height,n=t.width,r=t.getContext("2d");r.clearRect(0,0,n,e),a.state.audioArray.forEach(function(t,a){var n=5+t.amplitude,i=.2+n/50,o="rgba(244, 67, 54,"+i+")",s="rgba(255, 196, 0,"+i+")";r.fillStyle=t.annotated?s:o,r.fillRect(a*z,e/2-n,.6*z,2*n)})},a.state={audioArray:[],width:0},a.canvas=r.a.createRef(),a}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props.classes;return r.a.createElement("div",{className:t.Scroll},r.a.createElement("canvas",{className:t.Canvas,width:this.state.width,ref:this.canvas}))}}]),e}(n.Component),J=Object(S.a)(H)(V),$=function(){function t(e,a){var n=this;Object(m.a)(this,t),this.start=function(){n._recordingStartTimeMs=Date.now(),n._recordingInterval=setInterval(function(){n._onIntervalTick&&n._onIntervalTick(n.getElapsedTimeMs())},n._interval&&n._interval)},this.pause=function(){n._currentRecordingPausedStartTime=Date.now(),n._recordingPausedPeriods[n._currentRecordingPausedStartTime]=null},this.resume=function(){n._recordingPausedPeriods[n._currentRecordingPausedStartTime]=Date.now(),n._currentRecordingPausedStartTime=null},this.stop=function(){clearInterval(n._recordingInterval),n._recordingInterval=null,n._recordingStartTimeMs=null,n._recordingPausedPeriods={},n._currentRecordingPausedStartTime=null},this.isStarted=function(){return n._recordingInterval},this.getElapsedTimeMs=function(){var t=Date.now(),e=Object.keys(n._recordingPausedPeriods).map(function(e){return(n._recordingPausedPeriods[e]||t)-e}).reduce(function(t,e){return t+e},0);return t-n._recordingStartTimeMs-e},this._recordingInterval=null,this._recordingStartTimeMs=null,this._recordingPausedPeriods={},this._currentRecordingPausedStartTime=null,this._onIntervalTick=e,this._interval=a}return Object(h.a)(t,[{key:"setOnIntervalTick",value:function(t){this._onIntervalTick=t}}]),t}(),K={secondsToTimeString:function(t){var e=Math.floor(t/60),a=Math.floor(t%60);return a<10&&(a="0"+a),"".concat(e,":").concat(a)}},Q=a(37),X=a.n(Q),Y=a(38),Z=a.n(Y),tt=function(t){function e(t){return Object(m.a)(this,e),Object(p.a)(this,Object(g.a)(e).call(this,"Action Item",t,1e4))}return Object(f.a)(e,t),e}(function t(e,a,n){Object(m.a)(this,t),this.id=Z.a.v4(),this.timestamp=a,this.totalDuration=n,this.type=e}),et=a(39),at=a.n(et),nt=a(83),rt=a(82),it=a(40),ot=a.n(it),st={App:{height:"100%",textAlign:"center",background:at.a[800]},Duration:{margin:0,padding:"30px",textAlign:"center",color:"#fff",fontSize:50,fontWeight:"lighter"},Grid:{height:"100%"},AnnotationContainer:{minHeight:"100px"},Annotation:{padding:"8px"},AnnotationIcon:{height:"30px",width:"30px",marginRight:"2px"},AudioContainer:{minHeight:"340px"},AudioPlayer:{width:"800px",marginTop:"100px",marginBottom:"40px"}},ct=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(p.a)(this,Object(g.a)(e).call(this,t))).componentDidMount=function(){var t=document.createElement("script");t.src="https://cdn.webrtc-experiment.com/EBML.js",t.async=!0,document.body.appendChild(t)},a.componentDidUpdate=function(){var t=Object(d.a)(u.a.mark(function t(e,n){var r,i,o;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=a.state.recordingState.compareToPrevious(n.recordingState),t.t0=r,t.next=t.t0===x.START?4:t.t0===x.STOP?14:23;break;case 4:return t.next=6,a.requestPermission();case 6:return i=t.sent,a._recordingTimeManager.start(),a._recorder=new v.RecordRTCPromisesHandler(i,{type:"audio"}),t.next=11,a._recorder.startRecording();case 11:return o=a.state.audioItem.annotations,a.setState({recordingState:M.RECORDING,audioItem:new E(o,null,i)}),t.abrupt("break",24);case 14:return t.next=16,a._recorder.stopRecording();case 16:return t.t1=v.getSeekableBlob,t.next=19,a._recorder.getBlob();case 19:return t.t2=t.sent,t.t3=function(t){a._recordingTimeManager.stop(),a._audioAnalyzer.stop(),a.setState({recordingState:M.OFF,audioItem:Object(l.a)({},a.state.audioItem,{url:URL.createObjectURL(t)}),elapsedTimeMs:0})},(0,t.t1)(t.t2,t.t3),t.abrupt("break",24);case 23:return t.abrupt("break",24);case 24:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}(),a._onMsIntervalTick=function(t){a.setState({elapsedTimeMs:t})},a.toggleRecording=Object(d.a)(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.state.recordingState===M.RECORDING?a.setState({recordingState:a.state.recordingState.stop()}):a.state.recordingState===M.OFF&&(a.state.audioItem&&null==a.state.audioItem.url?a.setState({recordingState:a.state.recordingState.start()}):a.setState({audioItem:new E([],null,null)}));case 1:case"end":return t.stop()}},t)})),a.requestPermission=Object(d.a)(u.a.mark(function t(){var e;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},t)})),a.state={recordingState:M.OFF,audioItem:new E([],null,null),elapsedTimeMs:0},a._recordingTimeManager=new $(a._onMsIntervalTick,10),a}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;console.log(this.state.audioItem.stream||this.state.audioItem.url);var e=this.props.classes;return r.a.createElement(rt.a,{className:e.App,maxWidth:!1},r.a.createElement(nt.a,{container:!0,direction:"column",alignItems:"center",className:e.Grid},r.a.createElement(nt.a,{item:!0},r.a.createElement("h1",{className:e.Duration},K.secondsToTimeString(this.state.elapsedTimeMs/1e3))),r.a.createElement(nt.a,{item:!0},r.a.createElement(L,{onClick:this.toggleRecording,recordingState:this.state.recordingState,hasRecording:this.state.audioItem&&null!=this.state.audioItem.url})),r.a.createElement(nt.a,{item:!0,className:e.AudioContainer},this.state.audioItem&&this.state.audioItem.url?r.a.createElement(X.a,{className:e.AudioPlayer,src:this.state.audioItem.url,controls:!0,ref:function(e){e&&(t._audioPlayer=e)}}):r.a.createElement(J,{ref:function(e){e&&(t._audioAnalyzer=e)},recordingState:this.state.recordingState,audioItem:this.state.audioItem,elapsedTimeMs:this.state.elapsedTimeMs})),r.a.createElement(nt.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",className:e.AnnotationContainer},this.state.audioItem&&this.state.audioItem.annotations&&0!==this.state.audioItem.annotations.length&&this.state.audioItem.annotations.map(function(a){return r.a.createElement(nt.a,{item:!0,className:e.Annotation,key:a.id},r.a.createElement(A.a,{variant:"extended",disabled:!t.state.audioItem.url,onClick:function(){null!=t.state.audioItem.url&&null!=t._audioPlayer&&t._audioPlayer.audioEl&&(t._audioPlayer.audioEl.currentTime=(a.timestamp-a.totalDuration/2)/1e3,t._audioPlayer.audioEl.play())}},r.a.createElement(ot.a,{className:e.AnnotationIcon}),a.type))})),r.a.createElement(nt.a,{item:!0},r.a.createElement(R,{name:"Action Item",durationSecondsString:"10s",onAnnotationButtonClicked:this._onAnnotationButtonClicked(),disabled:null==this.state.audioItem.stream&&null==this.state.audioItem.url}))))}},{key:"_onAnnotationButtonClicked",value:function(){var t=this;return function(e){if("Action Item"===e){var a;t.state.recordingState===M.RECORDING?a=new tt(t.state.elapsedTimeMs):t.state.audioItem.url&&(a=new tt(1e3*t._audioPlayer.audioEl.currentTime));var n=t.state.audioItem,r=new E([].concat(Object(s.a)(n.annotations),[a]),n.url,n.stream);t.setState({audioItem:r})}}}}]),e}(n.Component),ut=Object(S.a)(st)(ct);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ut,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[46,1,2]]]);
//# sourceMappingURL=main.b72fc950.chunk.js.map