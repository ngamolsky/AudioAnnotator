(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(t,e,n){t.exports=n(62)},49:function(t,e,n){},62:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(16),o=n.n(i),s=(n(49),n(18)),c=n(15),u=n.n(c),l=n(39),d=n(25),m=n(4),h=n(5),p=n(11),g=n(10),f=n(12),v=n(26),S=n(82),O=n(78),I=n(17),b=n.n(I),T={ActionButton:{height:"60px",width:"200px",fontSize:24,backgroundColor:b.a[500],"&:hover":{backgroundColor:b.a[200]},color:"#fff",fontWeight:"lighter",marginTop:"20px",marginBottom:"60px"}},y=function(t){function e(){return Object(m.a)(this,e),Object(p.a)(this,Object(g.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=this.props.classes;return r.a.createElement(O.a,{className:e.ActionButton,onClick:function(){t.props.onAnnotationButtonClicked(t.props.name)}},this.props.name)}}]),e}(a.Component),R=Object(S.a)(T)(y),A=function t(e,n,a){var r=this;Object(m.a)(this,t),this.hasMedia=function(){return null!=(r.stream||r.url)},this.getAnnotationForTimestamp=function(t){var e;return r.annotations&&r.annotations.forEach(function(n){t<n.timestamp+n.totalDuration/2&&t>n.timestamp-n.totalDuration/2&&(e=n)}),e},this.annotations=e,this.url=n,this.stream=a},E=n(79),w=n(34),P=n.n(w),k=n(33),_=n.n(k),j=n(32),C=n.n(j),N={NONE:"NONE",START:"START",STOP:"STOP",PAUSE:"PAUSE",RESUME:"RESUME"},x={token:"unique recording state token"},D=function(){function t(e,n){if(Object(m.a)(this,t),e!==x)throw new Error("RecordingState is an enum and should not be constructed directly; please use an existing RecordingState.* declared in recording_state.es6.js");this._status=n}return Object(h.a)(t,[{key:"isActive",value:function(){return this===t.RECORDING||this===t.PAUSED}},{key:"isRecording",value:function(){return this===t.RECORDING}},{key:"isPaused",value:function(){return this===t.PAUSED}},{key:"isOff",value:function(){return this===t.OFF}},{key:"isStartingOrStopping",value:function(){return this===t.STARTING||this===t.STOPPING}},{key:"start",value:function(){return this===t.OFF?t.STARTING:this}},{key:"stop",value:function(){return this===t.OFF?t.OFF:t.STOPPING}},{key:"pause",value:function(){return t.PAUSED}},{key:"resume",value:function(){return t.RECORDING}},{key:"compareToPrevious",value:function(e){return this===t.STARTING&&e===t.OFF?N.START:this===t.STOPPING&&e!==t.STOPPING?N.STOP:this===t.RECORDING&&e===t.PAUSED?N.RESUME:this===t.PAUSED&&e===t.RECORDING?N.PAUSE:N.NONE}}]),t}();D.OFF=new D(x,"OFF"),D.STARTING=new D(x,"STARTING"),D.RECORDING=new D(x,"RECORDING"),D.PAUSED=new D(x,"PAUSED"),D.STOPPING=new D(x,"STOPPING");var M=D,G={RecordingButton:{height:"60px",width:"60px",marginBottom:"70px",backgroundColor:b.a[600],"&:hover":{backgroundColor:b.a[200]},color:"#fff"},RecordingButtonLabel:{height:"30px",width:"30px"}},F=function(t){function e(){return Object(m.a)(this,e),Object(p.a)(this,Object(g.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props.classes;return r.a.createElement(E.a,{className:t.RecordingButton,"aria-label":"record",onClick:this.props.onClick},this.props.recordingState===M.RECORDING?r.a.createElement(C.a,{className:t.RecordingButtonLabel}):this.props.hasRecording?r.a.createElement(_.a,{className:t.RecordingButtonLabel}):r.a.createElement(P.a,{className:t.RecordingButtonLabel}))}}]),e}(r.a.Component),B=Object(S.a)(G)(F),U=6,L=60,z=1e3,q={Scroll:{width:z,overflow:"hidden",direction:"rtl",margin:"20px",alignSelf:"center",alignItems:"center"},Canvas:{float:"right",height:"300px"}},W=function(t){function e(t){var n;return Object(m.a)(this,e),(n=Object(p.a)(this,Object(g.a)(e).call(this,t))).componentDidUpdate=function(t,e){e.audioArray!==n.state.audioArray&&n._draw();var a=t.audioItem,r=n.props.audioItem;!a.hasMedia()&&r.hasMedia()?(n.audioContext=new(window.AudioContext||window.webkitAudioContext),n.analyser=n.audioContext.createAnalyser(),n.analyser.smoothingTimeConstant=0,n.dataArray=new Uint8Array(n.analyser.frequencyBinCount),r.stream?(n.source=n.audioContext.createMediaStreamSource(r.stream),n.source.connect(n.analyser)):r.url&&console.log("HAVE URL"),n.timerID=setInterval(function(){n.props.recordingState===M.RECORDING&&n._onRefreshVisualizer()},L)):t.audioStream&&null==n.props.audioStream&&(n.analyser.disconnect(),n.source.disconnect(),n.setState({audioArray:[],width:z}))},n.componentWillUnmount=function(){clearInterval(n.timerID),n.analyser.disconnect(),n.source.disconnect()},n.stop=function(){clearInterval(n.timerID)},n._onRefreshVisualizer=function(){n.analyser.getByteFrequencyData(n.dataArray);for(var t=0,e=0;e<n.dataArray.length;e++)t+=n.dataArray[e];var a=Object(s.a)(n.state.audioArray),r=n.props.audioItem&&n.props.audioItem.getAnnotationForTimestamp(n.props.elapsedTimeMs);if(null!=r){var i=n.state.audioArray.slice(-r.totalDuration/2/L).map(function(t){return{amplitude:t.amplitude,annotated:!0,timestamp:t.elapsedTimeMs}});a.splice.apply(a,[a.length-i.length,r.totalDuration/2/L].concat(Object(s.a)(i)))}var o=t/n.dataArray.length;n.setState({width:n.state.audioArray.length*U,audioArray:[].concat(Object(s.a)(a),[{amplitude:o,annotated:null!=r,timestamp:n.props.elapsedTimeMs}])})},n._draw=function(){var t=n.canvas.current,e=t.height,a=t.width,r=t.getContext("2d");r.clearRect(0,0,a,e),n.state.audioArray.forEach(function(t,n){var a=5+t.amplitude,i=.2+a/50,o="rgba(244, 67, 54,"+i+")",s="rgba(255, 196, 0,"+i+")";r.fillStyle=t.annotated?s:o,r.fillRect(n*U,e/2-a,.6*U,2*a)})},n.state={audioArray:[],width:0},n.canvas=r.a.createRef(),n}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props.classes;return r.a.createElement("div",{className:t.Scroll},r.a.createElement("canvas",{className:t.Canvas,width:this.state.width,ref:this.canvas}))}}]),e}(a.Component),H=Object(S.a)(q)(W),V=function(){function t(e,n){var a=this;Object(m.a)(this,t),this.start=function(){a._recordingStartTimeMs=Date.now(),a._recordingInterval=setInterval(function(){a._onIntervalTick&&a._onIntervalTick(a.getElapsedTimeMs())},a._interval&&a._interval)},this.pause=function(){a._currentRecordingPausedStartTime=Date.now(),a._recordingPausedPeriods[a._currentRecordingPausedStartTime]=null},this.resume=function(){a._recordingPausedPeriods[a._currentRecordingPausedStartTime]=Date.now(),a._currentRecordingPausedStartTime=null},this.stop=function(){clearInterval(a._recordingInterval),a._recordingInterval=null,a._recordingStartTimeMs=null,a._recordingPausedPeriods={},a._currentRecordingPausedStartTime=null},this.isStarted=function(){return a._recordingInterval},this.getElapsedTimeMs=function(){var t=Date.now(),e=Object.keys(a._recordingPausedPeriods).map(function(e){return(a._recordingPausedPeriods[e]||t)-e}).reduce(function(t,e){return t+e},0);return t-a._recordingStartTimeMs-e},this._recordingInterval=null,this._recordingStartTimeMs=null,this._recordingPausedPeriods={},this._currentRecordingPausedStartTime=null,this._onIntervalTick=e,this._interval=n}return Object(h.a)(t,[{key:"setOnIntervalTick",value:function(t){this._onIntervalTick=t}}]),t}(),J={secondsToTimeString:function(t){var e=Math.floor(t/60),n=Math.floor(t%60);return n<10&&(n="0"+n),"".concat(e,":").concat(n)}},$=n(35),K=n.n($),Q=n(36),X=n.n(Q),Y=function(t){function e(t){return Object(m.a)(this,e),Object(p.a)(this,Object(g.a)(e).call(this,"Action Item",t,1e4))}return Object(f.a)(e,t),e}(function t(e,n,a){Object(m.a)(this,t),this.id=X.a.v4(),this.timestamp=n,this.totalDuration=a,this.type=e}),Z=n(37),tt=n.n(Z),et=n(81),nt=n(80),at=n(38),rt=n.n(at),it={App:{height:"100%",textAlign:"center",background:tt.a[800]},Duration:{margin:0,padding:"30px",textAlign:"center",color:"#fff",fontSize:50,fontWeight:"lighter"},Grid:{height:"100%"},AnnotationContainer:{minHeight:"100px"},Annotation:{padding:"8px"},AnnotationIcon:{height:"30px",width:"30px",marginRight:"2px"},AudioContainer:{minHeight:"340px"},AudioPlayer:{width:"800px",marginTop:"100px",marginBottom:"40px"}},ot=function(t){function e(t){var n;return Object(m.a)(this,e),(n=Object(p.a)(this,Object(g.a)(e).call(this,t))).componentDidMount=function(){var t=document.createElement("script");t.src="https://cdn.webrtc-experiment.com/EBML.js",t.async=!0,document.body.appendChild(t)},n.componentDidUpdate=function(){var t=Object(d.a)(u.a.mark(function t(e,a){var r,i,o;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=n.state.recordingState.compareToPrevious(a.recordingState),t.t0=r,t.next=t.t0===N.START?4:t.t0===N.STOP?14:23;break;case 4:return t.next=6,n.requestPermission();case 6:return i=t.sent,n._recordingTimeManager.start(),n._recorder=new v.RecordRTCPromisesHandler(i,{type:"audio"}),t.next=11,n._recorder.startRecording();case 11:return o=n.state.audioItem.annotations,n.setState({recordingState:M.RECORDING,audioItem:new A(o,null,i)}),t.abrupt("break",24);case 14:return t.next=16,n._recorder.stopRecording();case 16:return t.t1=v.getSeekableBlob,t.next=19,n._recorder.getBlob();case 19:return t.t2=t.sent,t.t3=function(t){n._recordingTimeManager.stop(),n._audioAnalyzer.stop(),n.setState({recordingState:M.OFF,audioItem:Object(l.a)({},n.state.audioItem,{url:URL.createObjectURL(t)}),elapsedTimeMs:0})},(0,t.t1)(t.t2,t.t3),t.abrupt("break",24);case 23:return t.abrupt("break",24);case 24:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),n._onMsIntervalTick=function(t){n.setState({elapsedTimeMs:t})},n.toggleRecording=Object(d.a)(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.state.recordingState===M.RECORDING?n.setState({recordingState:n.state.recordingState.stop()}):n.state.recordingState===M.OFF&&(n.state.audioItem&&null==n.state.audioItem.url?n.setState({recordingState:n.state.recordingState.start()}):n.setState({audioItem:new A([],null,null)}));case 1:case"end":return t.stop()}},t)})),n.requestPermission=Object(d.a)(u.a.mark(function t(){var e;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},t)})),n.state={recordingState:M.OFF,audioItem:new A([],null,null),elapsedTimeMs:0},n._recordingTimeManager=new V(n._onMsIntervalTick,10),n}return Object(f.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=this.props.classes;return r.a.createElement(nt.a,{className:e.App},r.a.createElement(et.a,{container:!0,direction:"column",alignItems:"center",className:e.Grid},r.a.createElement(et.a,{item:!0},r.a.createElement("h1",{className:e.Duration},J.secondsToTimeString(this.state.elapsedTimeMs/1e3))),r.a.createElement(et.a,{item:!0},r.a.createElement(B,{onClick:this.toggleRecording,recordingState:this.state.recordingState,hasRecording:this.state.audioItem&&null!=this.state.audioItem.url})),r.a.createElement(et.a,{item:!0,className:e.AudioContainer},this.state.audioItem&&this.state.audioItem.url?r.a.createElement(K.a,{className:e.AudioPlayer,src:this.state.audioItem.url,controls:!0,ref:function(e){e&&(t._audioPlayer=e)}}):r.a.createElement(H,{ref:function(e){e&&(t._audioAnalyzer=e)},recordingState:this.state.recordingState,audioItem:this.state.audioItem,elapsedTimeMs:this.state.elapsedTimeMs})),r.a.createElement(et.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",className:e.AnnotationContainer},this.state.audioItem&&this.state.audioItem.annotations&&this.state.audioItem.annotations.map(function(n){return r.a.createElement(et.a,{item:!0,className:e.Annotation,key:n.id},r.a.createElement(E.a,{variant:"extended",disabled:!t.state.audioItem.url,onClick:function(){null!=t.state.audioItem.url&&null!=t._audioPlayer&&(t._audioPlayer.audioEl.currentTime=(n.timestamp-n.totalDuration/2)/1e3,t._audioPlayer.audioEl.play())}},r.a.createElement(rt.a,{className:e.AnnotationIcon}),n.type))})),r.a.createElement(et.a,{item:!0},r.a.createElement(R,{name:"Action Item",onAnnotationButtonClicked:this._onAnnotationButtonClicked()}))))}},{key:"_onAnnotationButtonClicked",value:function(){var t=this;return function(e){if("Action Item"===e){var n;n=t.state.recordingState===M.RECORDING?new Y(t.state.elapsedTimeMs):new Y(1e3*t._audioPlayer.audioEl.currentTime);var a=t.state.audioItem,r=new A([].concat(Object(s.a)(a.annotations),[n]),a.url,a.stream);t.setState({audioItem:r})}}}}]),e}(a.Component),st=Object(S.a)(it)(ot);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(st,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[44,1,2]]]);
//# sourceMappingURL=main.24f8d392.chunk.js.map